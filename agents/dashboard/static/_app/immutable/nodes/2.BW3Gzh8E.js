import{f as q,a as R,c as ga}from"../chunks/Tjy3dR0-.js";import{i as Wa}from"../chunks/DwB8WAn_.js";import{o as Xa}from"../chunks/cGgwPYMa.js";import{h as A,a as Qa,b as Za,z as d,am as ja,r as $a,H as ae,s as ma,c as ya,d as na,k as X,X as ee,ak as re,a2 as ba,e as P,j as ca,l as te,ai as _a,an as se,S as Ea,ao as H,ap as le,aq as ne,ar as ie,i as wa,as as z,f as Na,p as Aa,at as ia,ae as oe,ah as fe,g as ve,W as ue,au as de,av as ce,aw as he,ax as _e,ay as pe,t as ge,U as me,az as ye,D as be,G as Ee,K as m,I as h,J as _,aA as x,F as oa,v as ka}from"../chunks/CbciU2_W.js";import{e as Sa,s as N}from"../chunks/C871yeIs.js";import{i as Q}from"../chunks/CL5kEOGl.js";function we(a,e){return e}function ke(a,e,r){for(var n=[],f=e.length,i,v=e.length,t=0;t<f;t++){let c=e[t];Aa(c,()=>{if(i){if(i.pending.delete(c),i.done.add(c),i.pending.size===0){var w=a.outrogroups;ha(_a(i.done)),w.delete(i),w.size===0&&(a.outrogroups=null)}}else v-=1},!1)}if(v===0){var l=n.length===0&&r!==null;if(l){var o=r,p=o.parentNode;fe(p),p.append(o),a.items.clear()}ha(e,!l)}else i={pending:new Set(e),done:new Set},(a.outrogroups??(a.outrogroups=new Set)).add(i)}function ha(a,e=!0){for(var r=0;r<a.length;r++)ve(a[r],e)}var xa;function Se(a,e,r,n,f,i=null){var v=a,t=new Map;A&&Qa();var l=null,o=ja(()=>{var g=r();return se(g)?g:g==null?[]:_a(g)}),p,c=!0;function w(){s.fallback=l,xe(s,p,v,e,n),l!==null&&(p.length===0?(l.f&z)===0?Na(l):(l.f^=z,Y(l,null,v)):Aa(l,()=>{l=null}))}var F=Za(()=>{p=d(o);var g=p.length;let D=!1;if(A){var T=$a(v)===ae;T!==(g===0)&&(v=ma(),ya(v),na(!1),D=!0)}for(var b=new Set,S=P,M=te(),E=0;E<g;E+=1){A&&X.nodeType===ee&&X.data===re&&(v=X,D=!0,na(!1));var U=p[E],C=n(U,E),y=c?null:t.get(C);y?(y.v&&ba(y.v,U),y.i&&ba(y.i,E),M&&S.skipped_effects.delete(y.e)):(y=Te(t,c?v:xa??(xa=wa()),U,C,E,f,e,r),c||(y.e.f|=z),t.set(C,y)),b.add(C)}if(g===0&&i&&!l&&(c?l=ca(()=>i(v)):(l=ca(()=>i(xa??(xa=wa()))),l.f|=z)),A&&g>0&&ya(ma()),!c)if(M){for(const[k,Z]of t)b.has(k)||S.skipped_effects.add(Z.e);S.oncommit(w),S.ondiscard(()=>{})}else w();D&&na(!0),d(o)}),s={effect:F,items:t,outrogroups:null,fallback:l};c=!1,A&&(v=X)}function xe(a,e,r,n,f){var y;var i=e.length,v=a.items,t=a.effect.first,l,o=null,p=[],c=[],w,F,s,g;for(g=0;g<i;g+=1){if(w=e[g],F=f(w,g),s=v.get(F).e,a.outrogroups!==null)for(const k of a.outrogroups)k.pending.delete(s),k.done.delete(s);if((s.f&z)!==0)if(s.f^=z,s===t)Y(s,null,r);else{var D=o?o.next:t;s===a.effect.last&&(a.effect.last=s.prev),s.prev&&(s.prev.next=s.next),s.next&&(s.next.prev=s.prev),L(a,o,s),L(a,s,D),Y(s,D,r),o=s,p=[],c=[],t=o.next;continue}if((s.f&ia)!==0&&Na(s),s!==t){if(l!==void 0&&l.has(s)){if(p.length<c.length){var T=c[0],b;o=T.prev;var S=p[0],M=p[p.length-1];for(b=0;b<p.length;b+=1)Y(p[b],T,r);for(b=0;b<c.length;b+=1)l.delete(c[b]);L(a,S.prev,M.next),L(a,o,S),L(a,M,T),t=T,o=M,g-=1,p=[],c=[]}else l.delete(s),Y(s,t,r),L(a,s.prev,s.next),L(a,s,o===null?a.effect.first:o.next),L(a,o,s),o=s;continue}for(p=[],c=[];t!==null&&t!==s;)(l??(l=new Set)).add(t),c.push(t),t=t.next;if(t===null)continue}(s.f&z)===0&&p.push(s),o=s,t=s.next}if(a.outrogroups!==null){for(const k of a.outrogroups)k.pending.size===0&&(ha(_a(k.done)),(y=a.outrogroups)==null||y.delete(k));a.outrogroups.size===0&&(a.outrogroups=null)}if(t!==null||l!==void 0){var E=[];if(l!==void 0)for(s of l)(s.f&ia)===0&&E.push(s);for(;t!==null;)(t.f&ia)===0&&t!==a.fallback&&E.push(t),t=t.next;var U=E.length;if(U>0){var C=null;ke(a,E,C)}}}function Te(a,e,r,n,f,i,v,t){var l=(v&ne)!==0?(v&ie)===0?H(r,!1,!1):Ea(r):null,o=(v&le)!==0?Ea(f):null;return{v:l,i:o,e:ca(()=>(i(e,l??r,o??f,t),()=>{a.delete(n)}))}}function Y(a,e,r){if(a.nodes)for(var n=a.nodes.start,f=a.nodes.end,i=e&&(e.f&z)===0?e.nodes.start:r;n!==null;){var v=oe(n);if(i.before(n),n===f)return;n=v}}function L(a,e,r){e===null?a.effect.first=r:e.next=r,r===null?a.effect.last=e:r.prev=e}function Ne(a,e,r){var n=a==null?"":""+a;return n=n?n+" "+e:e,n===""?null:n}function Ae(a,e,r,n,f,i){var v=a.__className;if(A||v!==r||v===void 0){var t=Ne(r,n);(!A||t!==a.getAttribute("class"))&&(t==null?a.removeAttribute("class"):a.className=t),a.__className=r}return i}const De=Symbol("is custom element"),Me=Symbol("is html");function fa(a){if(A){var e=!1,r=()=>{if(!e){if(e=!0,a.hasAttribute("value")){var n=a.value;Ta(a,"value",null),a.value=n}if(a.hasAttribute("checked")){var f=a.checked;Ta(a,"checked",null),a.checked=f}}};a.__on_r=r,ue(r),de()}}function Ta(a,e,r,n){var f=Ie(a);A&&(f[e]=a.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&a.nodeName==="LINK")||f[e]!==(f[e]=r)&&(e==="loading"&&(a[ce]=r),a.removeAttribute(e))}function Ie(a){return a.__attributes??(a.__attributes={[De]:a.nodeName.includes("-"),[Me]:a.namespaceURI===he})}function va(a,e,r=e){var n=new WeakSet;_e(a,"input",async f=>{var i=f?a.defaultValue:a.value;if(i=ua(a)?da(i):i,r(i),P!==null&&n.add(P),await pe(),i!==(i=e())){var v=a.selectionStart,t=a.selectionEnd,l=a.value.length;if(a.value=i??"",t!==null){var o=a.value.length;v===t&&t===l&&o>l?(a.selectionStart=o,a.selectionEnd=o):(a.selectionStart=v,a.selectionEnd=Math.min(t,o))}}}),(A&&a.defaultValue!==a.value||ge(e)==null&&a.value)&&(r(ua(a)?da(a.value):a.value),P!==null&&n.add(P)),me(()=>{var f=e();if(a===document.activeElement){var i=ye??P;if(n.has(i))return}ua(a)&&f===da(a.value)||a.type==="date"&&!f&&!a.value||f!==a.value&&(a.value=f??"")})}function ua(a){var e=a.type;return e==="number"||e==="range"}function da(a){return a===""?null:+a}function Re(a){return function(...e){var r=e[0];return r.preventDefault(),a==null?void 0:a.apply(this,e)}}const Da="/api";async function Ce(){const a=await fetch(`${Da}/dyad-tasks`);if(!a.ok)throw new Error(`Failed to load tasks: ${a.status}`);return a.json()}async function Oe(a,e,r){const n=await fetch(`${Da}/spawn`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,role:e,department:r})});if(!n.ok)throw new Error(`Spawn failed: ${n.status}`);return(await n.json()).output||"ok"}var Le=q('<div style="color:#a78bfa; font-size:13px;"> </div>'),He=q("<p>Loadingâ€¦</p>"),ze=q('<p style="color:#f87171;"> </p>'),Fe=q('<tr><td colspan="8" class="svelte-1uha8ag">No tasks</td></tr>'),Ue=q('<tr><td class="svelte-1uha8ag"> </td><td class="svelte-1uha8ag"> </td><td class="svelte-1uha8ag"> </td><td> </td><td class="svelte-1uha8ag"> </td><td class="svelte-1uha8ag"> </td><td class="svelte-1uha8ag"> </td><td class="svelte-1uha8ag"> </td></tr>'),Ve=q('<table class="svelte-1uha8ag"><thead><tr><th class="svelte-1uha8ag">ID</th><th class="svelte-1uha8ag">Title</th><th class="svelte-1uha8ag">Kind</th><th class="svelte-1uha8ag">Status</th><th class="svelte-1uha8ag">Dyad</th><th class="svelte-1uha8ag">Priority</th><th class="svelte-1uha8ag">Owner</th><th class="svelte-1uha8ag">Updated</th></tr></thead><tbody><!></tbody></table>'),qe=q('<main class="svelte-1uha8ag"><h1>Dyad Dashboard</h1> <p style="color:#9ca3af; max-width: 760px;">Monitor dyad tasks and spawn dyads. Data is proxied through the backend to Manager.</p> <div class="row svelte-1uha8ag" style="margin-top:16px;"><div class="col card svelte-1uha8ag"><h3>Spawn Dyad</h3> <div style="display:grid; gap:8px; margin-top:8px;"><label>Name <input placeholder="infra" class="svelte-1uha8ag"/></label> <label>Role <input placeholder="infra" class="svelte-1uha8ag"/></label> <label>Department <input placeholder="infra" class="svelte-1uha8ag"/></label> <button class="svelte-1uha8ag">Spawn</button> <!></div></div></div> <div class="card svelte-1uha8ag" style="margin-top:20px;"><div style="display:flex; justify-content:space-between; align-items:center;"><h3>Dyad Tasks</h3> <button style="width:auto; padding:6px 10px;" class="svelte-1uha8ag">Refresh</button></div> <!></div></main>');function We(a,e){be(e,!1);let r=H([]),n=H(!0),f=H(""),i=H(""),v=H("infra"),t=H("infra"),l=H("");async function o(){x(n,!0),x(f,"");try{x(r,await Ce())}catch(u){x(f,u instanceof Error?u.message:String(u))}finally{x(n,!1)}}async function p(){x(l,"");try{const u=await Oe(d(i).trim(),d(v).trim(),d(t).trim());x(l,u),await o()}catch(u){x(l,u instanceof Error?u.message:String(u))}}Xa(o),Wa();var c=qe(),w=m(h(c),4),F=h(w),s=m(h(F),2),g=h(s),D=m(h(g));fa(D),_(g);var T=m(g,2),b=m(h(T));fa(b),_(T);var S=m(T,2),M=m(h(S));fa(M),_(S);var E=m(S,2),U=m(E,2);{var C=u=>{var O=Le(),j=h(O,!0);_(O),oa(()=>N(j,d(l))),R(u,O)};Q(U,u=>{d(l)&&u(C)})}_(s),_(F),_(w);var y=m(w,2),k=h(y),Z=m(h(k),2);_(k);var Ma=m(k,2);{var Ia=u=>{var O=He();R(u,O)},Ra=u=>{var O=ga(),j=ka(O);{var Ca=B=>{var V=ze(),G=h(V,!0);_(V),oa(()=>N(G,d(f))),R(B,V)},Oa=B=>{var V=Ve(),G=m(h(V)),La=h(G);{var Ha=K=>{var J=Fe();R(K,J)},za=K=>{var J=ga(),Fa=ka(J);Se(Fa,1,()=>d(r),we,(Ua,I)=>{var $=Ue(),aa=h($),Va=h(aa,!0);_(aa);var ea=m(aa),qa=h(ea,!0);_(ea);var ra=m(ea),Ba=h(ra,!0);_(ra);var W=m(ra),Ka=h(W,!0);_(W);var ta=m(W),Pa=h(ta,!0);_(ta);var sa=m(ta),Ya=h(sa,!0);_(sa);var la=m(sa),Ga=h(la,!0);_(la);var pa=m(la),Ja=h(pa,!0);_(pa),_($),oa(()=>{N(Va,d(I).id),N(qa,d(I).title),N(Ba,d(I).kind),Ae(W,1,"status-"+d(I).status,"svelte-1uha8ag"),N(Ka,d(I).status),N(Pa,d(I).dyad),N(Ya,d(I).priority),N(Ga,d(I).claimed_by||"-"),N(Ja,d(I).updated_at||"")}),R(Ua,$)}),R(K,J)};Q(La,K=>{d(r).length===0?K(Ha):K(za,!1)})}_(G),_(V),R(B,V)};Q(j,B=>{d(f)?B(Ca):B(Oa,!1)},!0)}R(u,O)};Q(Ma,u=>{d(n)?u(Ia):u(Ra,!1)})}_(y),_(c),va(D,()=>d(i),u=>x(i,u)),va(b,()=>d(v),u=>x(v,u)),va(M,()=>d(t),u=>x(t,u)),Sa("click",E,Re(p)),Sa("click",Z,o),R(a,c),Ee()}export{We as component};
